library(ggplot2)

pred <- Predict(cox_splines, "log_TTC", fun = exp)
pred_df <- as.data.frame(pred)

# Back-transform x-axis to weeks
pred_df$TTC_WEEKS <- (exp(pred_df$log_TTC) - 1)

# Create clean plot
ggplot(pred_df, aes(x = TTC_WEEKS, y = yhat)) +
  geom_line(color = "black", size = 1.2) +  # Main HR curve
  geom_line(aes(y = lower), linetype = "dotted", color = "black") +  # Lower CI
  geom_line(aes(y = upper), linetype = "dotted", color = "black") +  # Upper CI
  scale_x_continuous(breaks = c(0, 4, 8, 12, 16)) +
  labs(x = "Time to Chemotherapy (Weeks)",
       y = "Hazard Ratio") +
  theme_classic(base_size = 12) +  # Clean theme like survminer
  theme(
    text = element_text(family = "Calibri"),
    axis.title = element_text(size = 14),
    axis.text = element_text(size = 12, color = "black"),
    axis.line = element_line(color = "black"),
    axis.ticks = element_line(color = "black"),
    plot.title = element_blank(),
    panel.grid = element_blank()
  )

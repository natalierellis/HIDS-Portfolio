
#engine that brings in all the flags 
import pandas as pd
def qc_engine(df):
    violations = []

    flag_functions = {
        'tdan_dx_grp_mullerian_ca': tdan_dx_grp_mullerian_ca
    }

    for name, func in flag_functions.items():
        try: 
            result = func(df)
            if not result.empty:
                result = result.copy()
                result['violation_flag'] = name
                violations.append(result)


        except KeyError:
            continue
    if violations:
            return pd.concat(violations, ignore_index = True)
    else: 
         print("No violations found.")
         return pd.DataFrame
    


#check mullerian ca in tdan_dx_grp 
def tdan_dx_grp_mullerian_ca(raw): 
    violation_mask = (
        (raw['tdan_dx_grp'] == 6) & (
            (raw['site_p'] != 10) |
            ((raw['site_p2'].notna()) & (raw['site_p2'] != 10)) |
            ((raw['site_p3'].notna()) & (raw['site_p3'] != 10))
        )
    )

    return raw[violation_mask]

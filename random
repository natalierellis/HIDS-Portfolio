def is_after_dr_or_tdan_phrase(row):
    if row['entity_type'] != "PERSON":
        return False
    
    full_text = row['Text']
    start_idx = row['start']
    end_idx = row['end']
    detected_text = full_text[start_idx:end_idx].lower().strip()
    
    # Exclude if span is in "last tdan fu"
    if any(phrase in detected_text for phrase in ["last", "tdan", "fu"]):
        return True
    
    # Check if preceded by "Dr."
    before = full_text[:start_idx].lower().strip()
    words = before.split()
    if words and words[-1].rstrip(".") == "dr":
        return True

    return False

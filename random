library(tidyverse)

# Set the factor order
ordered_levels <- c("<=3 Weeks", "3-5 Weeks", "5-7 Weeks", "7-12 Weeks", "> 12 Weeks")

# Reshape and clean data
df_long <- SigHRSubgroupAnalysis %>%
  pivot_longer(
    cols = -1,
    names_to = "TimeInterval",
    values_to = "HR"
  ) %>%
  rename(Subgroup = 1) %>%
  filter(!is.na(HR)) %>%
  mutate(TimeInterval = factor(TimeInterval, levels = ordered_levels))

# Add a black reference dot at x = "3-5 Weeks", y = 1
# IMPORTANT: Match the factor exactly
black_dot <- tibble(
  TimeInterval = factor("3-5 Weeks", levels = levels(df_long$TimeInterval)),
  HR = 1,
  Subgroup = NA  # dummy value just in case
)

# Combine the data to ensure matching structure (optional but safe)
combined_data <- bind_rows(df_long, black_dot)

# Plot
ggplot(df_long, aes(x = TimeInterval, y = HR, color = Subgroup)) +
  geom_point(position = position_jitter(width = 0.1), size = 2.5) +
  geom_point(data = black_dot, aes(x = TimeInterval, y = HR),
             inherit.aes = FALSE, color = "black", size = 3) +
  theme_minimal() +
  labs(title = "Hazard Ratios by Time Interval and Subgroup",
       x = "Time Interval", y = "Hazard Ratio") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

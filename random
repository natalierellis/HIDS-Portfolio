violation_mask = (
    (raw['tdan_dx_grp'] == 6) & (    # ONLY applies to Mullerian cancer cases
        (~raw['site_p'].isin(valid_primary_sites))        # site_p must be in the valid set
        | ((raw['site_p2'].notna()) & ~raw['site_p2'].isin(valid_primary_sites))  # if site_p2 is filled, it must be valid
        | ((raw['site_p3'].notna()) & ~raw['site_p3'].isin(valid_primary_sites))  # if site_p3 is filled, it must be valid
    )
)

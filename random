If:

r
Copy
Edit
tdan_dx_grp == "Concurrent GynCA and NonGynCA"
Then:

site_p must be one of the valid GYN sites:

"Ovarian"

"Fallopian Tube"

"Primary Peritoneal"

"Tubo-Ovarian"

"Uterine Corpus"

"Mullerian origin NOS Unk GYN Site"

site_p2 and site_p3 must be:

"Other", blank (""), or NA

dx_grp_concurrent_gynca_nongynca_invalid_sites <- function(df) {
  required_cols <- c("tdan_dx_grp", "site_p", "site_p2", "site_p3")
  if (!all(required_cols %in% names(df))) return(NULL)

  valid_primary <- c(
    "Ovarian",
    "Fallopian Tube",
    "Primary Peritoneal",
    "Tubo-Ovarian",
    "Uterine Corpus",
    "Mullerian origin NOS Unk GYN Site"
  )
  
  valid_secondary <- c("Other", "", NA)

  df %>%
    filter(tdan_dx_grp == "Concurrent GynCA and NonGynCA") %>%
    filter(!(site_p %in% valid_primary &
             site_p2 %in% valid_secondary &
             site_p3 %in% valid_secondary)) %>%
    mutate(
      issue_description = "Concurrent GynCA and NonGynCA: site_p must be a valid GYN site; site_p2 and site_p3 must be 'Other' or blank"
    ) %>%
    select(cid, issue_description)
}

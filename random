library(tidyverse)

# Define factor order
ordered_levels <- c("<=3 Weeks", "3-5 Weeks", "5-7 Weeks", "7-12 Weeks", "> 12 Weeks")

# Reshape and clean
df_long <- SigHRSubgroupAnalysis %>%
  pivot_longer(cols = -1,
               names_to = "TimeInterval",
               values_to = "HR") %>%
  rename(Subgroup = 1) %>%
  filter(!is.na(HR)) %>%
  mutate(TimeInterval = factor(TimeInterval, levels = ordered_levels),
         IsReference = TimeInterval == "3-5 Weeks")

# Plot with separate layers
ggplot() +
  # First: black points for reference group
  geom_point(data = df_long %>% filter(IsReference),
             aes(x = TimeInterval, y = HR),
             color = "black", size = 2.5, position = position_jitter(width = 0.1)) +
  # Second: colored points for other groups
  geom_point(data = df_long %>% filter(!IsReference),
             aes(x = TimeInterval, y = HR, color = Subgroup),
             size = 2.5, position = position_jitter(width = 0.1)) +
  theme_minimal() +
  labs(title = "Hazard Ratios by Time Interval and Subgroup",
       x = "Time Interval", y = "Hazard Ratio") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

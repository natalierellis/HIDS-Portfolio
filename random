library(flextable)
library(dplyr)

# Define colors and line weight
navy <- "#000080"
light_blue <- "#ADD8E6"
bold_line <- fp_border(color = navy, width = 2)
regular_line <- fp_border(color = navy, width = 1)

# Ensure 'year' is text to prevent thousands separator
final_table <- final_table %>%
  mutate(year = as.character(year))

# Create flextable
ft <- flextable(final_table) %>%
  # General styling
  font(fontname = "Calibri", part = "all") %>%
  bold(part = "all") %>%  # Slightly thicker font
  align(align = "center", part = "all") %>%
  valign(valign = "center", part = "all") %>%
  
  # Header: navy bg, white text, NO borders
  bg(part = "header", bg = navy) %>%
  color(part = "header", color = "white") %>%
  border_remove(part = "header") %>%
  
  # Body text and borders
  color(part = "body", color = navy) %>%
  border_outer(part = "body", border = regular_line) %>%
  border_inner(part = "body", border = regular_line) %>%
  
  # Year column: light blue background
  bg(j = "year", bg = light_blue, part = "body") %>%
  
  # Thicker grid lines for Total and Withdrawn columns
  border(j = "Total", part = "body", border.left = bold_line, border.right = bold_line) %>%
  border(j = "Withdrawn", part = "body", border.left = bold_line, border.right = bold_line) %>%
  
  # Resize to fit
  autofit()

